{"version":3,"sources":["scripts/conic-gradient.js"],"names":["π","Math","PI","τ","deg","dummy","document","createElement","head","appendChild","_","self","ConicGradient","o","all","push","canvas","context","getContext","repeating","size","max","innerWidth","innerHeight","width","height","stops","split","from","i","length","stop","ColorStop","next","splice","color","indexOf","pos","shift","undefined","first","clone","unshift","last","forEach","j","difference","slice","s","paint","prototype","toString","dataURL","encodeURIComponent","svg","blobURL","URL","createObjectURL","Blob","type","png","toDataURL","r","sqrt","c","prevStop","diff","t","radius","x","stopIndex","translate","rotate","sameColor","map","interpolated","d","ret","fillStyle","join","beginPath","moveTo","θ","beginArg","endArg","min","arc","closePath","fill","gradient","parts","match","colorToRGBA","unit","Array","isArray","style","rgba","getComputedStyle","a","isNaN","StyleFix","supportedBackgroundImage","checkStyle","backgroundImage","PrefixFree","prefix","installGradientFix","gradientExp","fix","RegExp","register","css","raw","replace","dualPositionFix","adjustedStops","conicGradientFix"],"mappings":"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","file":"conic-gradient.dad86ae0.map","sourceRoot":"../../celebration","sourcesContent":["/**\n * CSS conic-gradient() polyfill\n * By Lea Verou — http://lea.verou.me\n * MIT license\n */\n\n(function(){\n\nvar π = Math.PI;\nvar τ = 2 * π;\nvar ε = .00001;\nvar deg = π/180;\n\nvar dummy = document.createElement(\"div\");\ndocument.head.appendChild(dummy);\n\nvar _ = self.ConicGradient = function(o) {\n\tvar me = this;\n\t_.all.push(this);\n\n\to = o || {};\n\n\tthis.canvas = document.createElement(\"canvas\");\n\tthis.context = this.canvas.getContext(\"2d\");\n\n\tthis.repeating = !!o.repeating;\n\n\tthis.size = o.size || Math.max(innerWidth, innerHeight);\n\n\tthis.canvas.width = this.canvas.height = this.size;\n\n\tvar stops = o.stops;\n\n\tthis.stops = (stops || \"\").split(/\\s*,(?![^(]*\\))\\s*/); // commas that are not followed by a ) without a ( first\n\n\tthis.from = 0;\n\n\tfor (var i=0; i<this.stops.length; i++) {\n\t\tif (this.stops[i]) {\n\t\t\tvar stop = this.stops[i] = new _.ColorStop(this, this.stops[i]);\n\n\t\t\tif (stop.next) {\n\t\t\t\tthis.stops.splice(i+1, 0, stop.next);\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.stops.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\n\tif (this.stops[0].color.indexOf('from') == 0) {\n\t\tthis.from = this.stops[0].pos*360;\n\t\tthis.stops.shift();\n\t}\n\t// Normalize stops\n\n\t// Add dummy first stop or set first stop’s position to 0 if it doesn’t have one\n\tif (this.stops[0].pos === undefined) {\n\t\t\tthis.stops[0].pos = 0;\n\t\t}\n\telse if (this.stops[0].pos > 0) {\n\t\tvar first = this.stops[0].clone();\n\t\tfirst.pos = 0;\n\t\tthis.stops.unshift(first);\n\t}\n\n\t// Add dummy last stop or set last stop’s position to 100% if it doesn’t have one\n\tif (this.stops[this.stops.length - 1].pos === undefined) {\n\t\tthis.stops[this.stops.length - 1].pos = 1;\n\t}\n\telse if (!this.repeating && this.stops[this.stops.length - 1].pos < 1) {\n\t\tvar last = this.stops[this.stops.length - 1].clone();\n\t\tlast.pos = 1;\n\t\tthis.stops.push(last);\n\t}\n\n\tthis.stops.forEach(function(stop, i){\n\t\tif (stop.pos === undefined) {\n\t\t\t// Evenly space color stops with no position\n\t\t\tfor (var j=i+1; this[j]; j++) {\n\t\t\t\tif (this[j].pos !== undefined) {\n\t\t\t\t\tstop.pos = this[i-1].pos + (this[j].pos - this[i-1].pos)/(j-i+1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (i > 0) {\n\t\t\t// Normalize color stops whose position is smaller than the position of the stop before them\n\t\t\tstop.pos = Math.max(stop.pos, this[i-1].pos);\n\t\t}\n\t}, this.stops);\n\n\tif (this.repeating) {\n\t\t// Repeat color stops until >= 1\n\t\tvar stops = this.stops.slice();\n\t\tvar lastStop = stops[stops.length-1];\n\t\tvar difference = lastStop.pos - stops[0].pos;\n\n\t\tfor (var i=0; this.stops[this.stops.length-1].pos < 1 && i<10000; i++) {\n\t\t\tfor (var j=0; j<stops.length; j++) {\n\t\t\t\tvar s = stops[j].clone();\n\t\t\t\ts.pos += (i+1)*difference;\n\n\t\t\t\tthis.stops.push(s);\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.paint();\n};\n\n_.all = [];\n\n_.prototype = {\n\ttoString: function() {\n\t\treturn \"url('\" + this.dataURL + \"')\";\n\t},\n\n\tget dataURL() {\n\t\t// IE/Edge only render data-URI based background-image when the image data\n\t\t// is escaped.\n\t\t// Ref: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7157459/#comment-3\n\t\treturn \"data:image/svg+xml,\" + encodeURIComponent(this.svg);\n\t},\n\n\tget blobURL() {\n\t\t// Warning: Flicker when updating due to slow blob: URL resolution :(\n\t\t// TODO cache this and only update it when color stops change\n\t\treturn URL.createObjectURL(new Blob([this.svg], {type: \"image/svg+xml\"}));\n\t},\n\n\tget svg() {\n\t\treturn '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"none\">' +\n\t\t\t'<svg viewBox=\"0 0 100 100\" preserveAspectRatio=\"xMidYMid slice\">' +\n\t\t\t'<image width=\"100\" height=\"100%\" xlink:href=\"' + this.png + '\" /></svg></svg>';\n\t},\n\n\tget png() {\n\t\treturn this.canvas.toDataURL();\n\t},\n\n\tget r() {\n\t\treturn Math.sqrt(2) * this.size / 2;\n\t},\n\n\t// Paint the conical gradient on the canvas\n\t// Algorithm inspired from http://jsdo.it/akm2/yr9B\n\tpaint: function() {\n\t\tvar c = this.context;\n\n\t\tvar radius = this.r;\n\t\tvar x = this.size / 2;\n\n\t\tvar stopIndex = 0; // The index of the current color\n\t\tvar stop = this.stops[stopIndex], prevStop;\n\n\t\tvar diff, t;\n\n\t\t// Transform coordinate system so that angles start from the top left, like in CSS\n\t\tc.translate(this.size/2, this.size/2);\n\t\tc.rotate(-90*deg);\n\t\tc.rotate(this.from*deg);\n\t\tc.translate(-this.size/2, -this.size/2);\n\n\t\tfor (var i = 0; i < 360;) {\n\t\t\tif (i/360 + ε >= stop.pos) {\n\t\t\t\t// Switch color stop\n\t\t\t\tdo {\n\t\t\t\t\tprevStop = stop;\n\n\t\t\t\t\tstopIndex++;\n\t\t\t\t\tstop = this.stops[stopIndex];\n\t\t\t\t// Continue while point is behind current position (i)\n\t\t\t\t} while(stop && stop != prevStop && i/360 + ε >= stop.pos);\n\n\t\t\t\tif (!stop) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tvar sameColor = prevStop.color + \"\" === stop.color + \"\" && prevStop != stop;\n\n\t\t\t\tdiff = prevStop.color.map(function(c, i){\n\t\t\t\t\treturn stop.color[i] - c;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tt = (i/360 - prevStop.pos) / (stop.pos - prevStop.pos);\n\n\t\t\tvar interpolated = sameColor? stop.color : diff.map(function(d,i){\n\t\t\t\tvar ret = d * t + prevStop.color[i];\n\n\t\t\t\treturn i < 3? ret & 255 : ret;\n\t\t\t});\n\n\t\t\t// Draw a series of arcs, 1deg each\n\t\t\tc.fillStyle = 'rgba(' + interpolated.join(\",\") + ')';\n\t\t\tc.beginPath();\n\t\t\tc.moveTo(x, x);\n\n\t\t\tif (sameColor) {\n\t\t\t\tvar θ = 360 * (stop.pos - prevStop.pos);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar θ = .5;\n\t\t\t}\n\n\t\t\tvar beginArg = i*deg;\n\t\t\tbeginArg = Math.min(360*deg, beginArg);\n\n\t\t\t// .02: To prevent empty blank line and corresponding moire\n\t\t\t// only non-alpha colors are cared now\n\t\t\tvar endArg = beginArg + θ*deg;\n\t\t\tendArg = Math.min(360*deg, endArg + .02);\n\n\t\t\tc.arc(x, x, radius, beginArg, endArg);\n\n\t\t\tc.closePath();\n\t\t\tc.fill();\n\n\t\t\ti += θ;\n\t\t}\n\t}\n};\n\n_.ColorStop = function(gradient, stop) {\n\tthis.gradient = gradient;\n\n\tif (stop) {\n\t\tvar parts = stop.match(/^(.+?)(?:\\s+([\\d.]+)(%|deg|turn|grad|rad)?)?(?:\\s+([\\d.]+)(%|deg|turn|grad|rad)?)?\\s*$/);\n\n\t\tthis.color = _.ColorStop.colorToRGBA(parts[1]);\n\n\t\tif (parts[2]) {\n\t\t\tvar unit = parts[3];\n\n\t\t\tif (unit == \"%\" || parts[2] === \"0\" && !unit) {\n\t\t\t\tthis.pos = parts[2]/100;\n\t\t\t}\n\t\t\telse if (unit == \"turn\") {\n\t\t\t\tthis.pos  = +parts[2];\n\t\t\t}\n\t\t\telse if (unit == \"deg\") {\n\t\t\t\tthis.pos  = parts[2] / 360;\n\t\t\t}\n\t\t\telse if (unit == \"grad\") {\n\t\t\t\tthis.pos  = parts[2] / 400;\n\t\t\t}\n\t\t\telse if (unit == \"rad\") {\n\t\t\t\tthis.pos  = parts[2] / τ;\n\t\t\t}\n\t\t}\n\n\t\tif (parts[4]) {\n\t\t\tthis.next = new _.ColorStop(gradient, parts[1] + \" \" + parts[4] + parts[5]);\n\t\t}\n\t}\n}\n\n_.ColorStop.prototype = {\n\tclone: function() {\n\t\tvar ret = new _.ColorStop(this.gradient);\n\t\tret.color = this.color;\n\t\tret.pos = this.pos;\n\n\t\treturn ret;\n\t},\n\n\ttoString: function() {\n\t\treturn \"rgba(\" + this.color.join(\", \") + \") \" + this.pos * 100 + \"%\";\n\t}\n};\n\n_.ColorStop.colorToRGBA = function(color) {\n\tif (!Array.isArray(color) && color.indexOf(\"from\") == -1) {\n\t\tdummy.style.color = color;\n\n\t\tvar rgba = getComputedStyle(dummy).color.match(/rgba?\\(([\\d.]+), ([\\d.]+), ([\\d.]+)(?:, ([\\d.]+))?\\)/);\n\n\t\tif (rgba) {\n\t\t\trgba.shift();\n\t\t\trgba = rgba.map(function(a) { return +a });\n\t\t\trgba[3] = isNaN(rgba[3])? 1 : rgba[3];\n\t\t}\n\n\t\treturn rgba || [0,0,0,0];\n\t}\n\n\treturn color;\n};\n\n})();\n\nif (self.StyleFix) {\n\t(function(){\n\t\tfunction supportedBackgroundImage(checkStyle) {\n\t\t\tvar dummy = document.createElement(\"p\");\n\t\t\tdummy.style.backgroundImage = checkStyle;\n\t\t\tdummy.style.backgroundImage = PrefixFree.prefix + checkStyle;\n\t\t\treturn !!dummy.style.backgroundImage;\n\t\t}\n\n\t\tfunction installGradientFix(gradientExp, fix) {\n\t\t\tvar match = new RegExp(\"(?:repeating-)?\" + gradientExp + \"\\\\(\\\\s*((?:\\\\([^()]+\\\\)|[^;()}])+?)\\\\)\", \"g\");\n\t\t\tStyleFix.register(function(css, raw) {\n\t\t\t\treturn (css.indexOf(\"-gradient\") > -1) ? css.replace(match, fix) : css;\n\t\t\t});\n\t\t}\n\n\t\t// Emulates conic-gradient in the absence of a native implementation.\n\t\tfunction conicGradientFix(gradient, stops) {\n\t\t\treturn new ConicGradient({\n\t\t\t\tstops: stops,\n\t\t\t\trepeating: gradient.indexOf(\"repeating-\") > -1\n\t\t\t});\n\t\t}\n\n\t\t// Converts dual-position color stops (CSS Images Module Level 4) if not supported.\n\t\tfunction dualPositionFix(gradient, stops) {\n\t\t\tvar adjustedStops = \"\";\n\t\t\t(stops || \"\").split(/\\s*,(?![^(]*\\))\\s*/).forEach(function(stop, i) {\n\t\t\t\tif (!stop) return;\n\n\t\t\t\tadjustedStops += (adjustedStops != \"\") ? \", \" : \"\";\n\n\t\t\t\tvar parts = stop.split(/ /);\n\t\t\t\tif (parts.length === 3) {\n\t\t\t\t\t// When the color stop has 3 components, assume it uses dual-positioning and convert:\n\t\t\t\t\t//     \"color pos0 pos1\" -> \"color pos0, color pos1\"\n\t\t\t\t\tadjustedStops += parts[0] + \" \" + parts[1] + \", \" + parts[0] + \" \" + parts[2];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tadjustedStops += stop;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn gradient.replace(stops, adjustedStops);\n\t\t}\n\n\t\t// First see if we need need a polyfill for dual-position color stops.\n\t\tif (!supportedBackgroundImage(\"linear-gradient(white 0% 50%, black 50% 100%)\"))\n\t\t\tinstallGradientFix(\"(?:linear|radial|conic)-gradient\", dualPositionFix);\n\n\t\t// Then check whether we need to polyfill conic-gradient.\n\t\tif (!supportedBackgroundImage(\"conic-gradient(white, black)\"))\n\t\t\tinstallGradientFix(\"conic-gradient\", conicGradientFix);\n\t})();\n}\n"]}